---
kind: pipeline
type: docker
name: default

steps:
- name: test
  image: python:3-alpine
  commands:
  - pip install tox
  - tox

- name: pypi-publish
  image: plugins/pypi
  settings:
    username:
      from_secret: public_pypi_username
    password:
      from_secret: public_pypi_password
  when:
    event:
    - tag

trigger:
  ref:
  - refs/heads/master
  - refs/heads/develop
  - refs/heads/feature/*
  - refs/tags/*
